<!DOCTYPE html><html xmlns="https://www.w3.org/1999/xhtml" ng-app="reusebooking"><head>    <meta http-equiv="cache-control" content="max-age=0" />    <meta http-equiv="cache-control" content="no-cache" />    <meta http-equiv="expires" content="0" />    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />    <meta http-equiv="pragma" content="no-cache" />    <title></title>    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/3.4.5/select2.css">    <link href="/includes/css/style.min.css" rel="stylesheet" />    <style>        .loading-background {            background: rgba(255, 255, 255, 0.9);            /*background: #777;*/            position: absolute;            top: 0;            bottom: 0;            left: 0;            right: 0;        }        .loading-background .loading-panel {            position: absolute;            top: 50%;            left: 50%;            background-color: #fff;            padding: 40px;            text-align: center;            width: 150px;            height: 150px;            border-radius: 75px;            -webkit-transform: translate(-50%, -50%);            -moz-transform: translate(-50%, -50%);            -ms-transform: translate(-50%, -50%);            -o-transform: translate(-50%, -50%);            transform: translate(-50%, -50%);        }        .loading-background .loading-panel img {            width: 70px;            margin-bottom: 0px;        }        #dispatch-booking-edit .body {            padding: 5px;            padding-bottom: 0;            min-height: 225px;        }        #dispatch-booking-edit .body h3 .section-title {            font-size: 16px;            margin-bottom: 8px;        }        #dispatch-booking-edit .body nav ul {            padding-left: 0;            margin-top: 0px;            border-bottom: 3px solid gray;            list-style: none !important;            margin-bottom: 5px;        }        #dispatch-booking-edit .body nav li {            display: inline-block;            border-right: 1px solid #ddd;            border: 0;        }        #dispatch-booking-edit .body nav li a {            padding: 8px 16px;            position: relative;            font-size: 14px;            text-transform: uppercase;            font-weight: 600;            display: block;        }        #dispatch-booking-edit .body nav ul li:last-child {            border-right: 0;        }        #dispatch-booking-edit .body nav ul li.active {            background: #788195;        }        #dispatch-booking-edit .body nav ul li.active a {            color: #fff;        }        #dispatch-booking-edit .body .table-wrapper thead tr th {            color: #455674;        }        #dispatch-booking-edit .body .table-wrapper i {            color: #455674;        }        #dispatch-booking-edit .add-stop {            padding-top: 25px;        }        #dispatch-booking-edit .add-stop a {            color: #455674 !important;        }        #dispatch-booking-edit .header {            background-color: #788195;            margin-bottom: 16px;            padding-left: 8px;            text-transform: uppercase;            color: #fff;            font-weight: 600;        }        #dispatch-booking-edit .selectize-dropdown small.text-muted {            margin-bottom: 0 !important;        }        #dispatch-booking-edit .client-info img {            width: 100px;            height: 100px;            border-radius: 50px;            box-shadow: 2px 3px 7px -3px rgba(0, 0, 0, .5);            display: block;            margin-left: auto;            margin-right: auto;        }        #dispatch-booking-edit .client-info .info-wrapper {            height: 120px;            display: -webkit-box;            display: -webkit-flex;            display: -ms-flexbox;            display: flex;            -webkit-box-align: center;            -webkit-align-items: center;            -ms-flex-align: center;            align-items: center;            -webkit-box-pack: center;            -webkit-justify-content: center;            -ms-flex-pack: center;            justify-content: center;        }        #dispatch-booking-edit .client-info .info-wrapper .info {            width: 100%;            text-align: left;        }        #dispatch-booking-edit .client-info .info-wrapper h4 {            font-size: 16px;            color: #455674;        }        #dispatch-booking-edit .client-info .info-wrapper h6 {            font-size: 14px;            color: #A88ADC;        }        #dispatch-booking-edit .verification .references {            position: absolute;            z-index: 1000;            max-height: 300px;            box-shadow: 0 4px 100px -12px #858585;            left: 0;            top: 35px;            background-color: #fff;            right: 40px;            padding: 0;        }        #dispatch-booking-edit .verification .references ul {            list-style: none;            padding-left: 0;        }        #dispatch-booking-edit .verification .references ul li {            border-bottom: 1px solid #eee;            padding: 4px 8px;        }        #dispatch-booking-edit .notes-tab {            margin: 10px 0 15px;        }        #dispatch-booking-edit .notes-tab li {            border: 0;            background: 0 0;            border-radius: 2px;            padding: 0 8px;            width: auto;            font-size: 12px !important;            text-transform: uppercase !important;            cursor: pointer;            color: #777;        }        #dispatch-booking-edit .notes-tab li a {            padding: 5px;        }        #dispatch-booking-edit .notes-tab li a::after,        .booking-edit-modal #dispatch-booking-edit .notes-tab li a::before {            display: none;        }        #dispatch-booking-edit .notes-tab li.active {            background-color: #788195;            color: #fff;        }        #dispatch-booking-edit .notes-tab li.active a {            color: #fff;        }        #dispatch-booking-edit .block {            background-color: #f4f4f4;            border: 1px solid #ddd;            padding: 16px 16px 5px 16px;            margin-bottom: 5px;        }        #dispatch-booking-edit .block h3 {            margin-top: 0;        }        #dispatch-booking-edit .block h3 i {            font-size: 36px;            margin-top: -6px;            color: #788195;        }        #dispatch-booking-edit .block .check + label.check-label {            background-color: #b1b6c2;        }        #dispatch-booking-edit .block .flip {            position: absolute;            right: -24px;            bottom: -34px;            padding: 8px;            z-index: 1;        }        #dispatch-booking-edit .block .flip i {            font-size: 34px;            color: #455674 !important;            font-weight: 700;        }        #dispatch-booking-edit .block small.text-muted {            display: block;            margin-bottom: 8px;        }        #dispatch-booking-edit .block .table-wrapper {            margin: 0 -16px !important;        }        #dispatch-booking-edit .block .table-wrapper table {            margin-bottom: -18px;        }        #dispatch-booking-edit .block .table-wrapper table td {            padding: 2px 8px;        }        #dispatch-booking-edit .block.passenger-history {            max-height: 350px;            overflow: auto;        }        #dispatch-booking-edit .quick-links {            margin-top: -12px;            margin-bottom: 16px;        }        #dispatch-booking-edit .quick-links a.linked {            opacity: 40;            filter: alpha(opacity=4000);            opacity: .4;            filter: alpha(opacity=40);            color: #00b300;            font-weight: 600;            text-transform: uppercase;            font-size: 11px;            margin-right: 5px;            padding: 2px 5px;            border-radius: 2px;            background-color: #fff;            cursor: pointer;            border: 1px solid #00b300;            -webkit-transition: all 1s;            transition: all 1s;        }        #dispatch-booking-edit .quick-links a.linked:hover {            opacity: 100;            filter: alpha(opacity=10000);            opacity: 1;            filter: alpha(opacity=100);            color: #fff;            background-color: #00b300;        }        #dispatch-booking-edit .add-passenger {            font-size: 18px;            position: relative;            top: 3px;            margin-right: 2px;        }        #dispatch-booking-edit .overlay {            position: absolute;            top: 0;            bottom: 0;            left: 0;            right: 0;            z-index: 100;            background-color: rgba(255, 255, 255, .7);        }        #dispatch-booking-edit .form-section .full-column {            width: 100%;            padding-right: 15px;            float: left;            position: relative;        }        #dispatch-booking-edit .form-section .half-column {            width: 50%;            padding-right: 15px;            float: left;            position: relative;        }        #dispatch-booking-edit .form-section .three-fourth-column {            width: 75%;            padding-right: 15px;            float: left;            position: relative;        }        #dispatch-booking-edit .form-section .third-column {            width: 33.33%;            padding-right: 15px;            float: left;            position: relative;        }        #dispatch-booking-edit .form-section .fourth-column {            width: 25%;            padding-right: 15px;            float: left;            position: relative;        }        #dispatch-booking-edit .form-section::after {            clear: both;        }        #dispatch-booking-edit .form-section .location-suggestions {            width: 280px;        }    </style>    <script type="text/javascript" src="https://www.google.com/jsapi"></script>    <script src="/webapp/config.js"></script>    <script>        var token = localStorage.getItem('AUTH_TKN');        var parsed = JSON.parse(token);        document.write('<scr' + 'ipt type="text/javascript" src="https://maps.googleapis.com/maps/api/js?' + (parsed.GoogleApiKey ? ('key=' + parsed.GoogleApiKey + '&') : '') + 'libraries=weather,visualization,places,drawing,geometry&sensor=false&language=en&v=3.13"><' + '/scr' + 'ipt>')    </script>    <!-- build:bower -->    <script src="/bower_components/jquery/dist/jquery.min.js"></script>    <script src="/bower_components/jquery-ui/jquery-ui.min.js"></script>    <script src="/bower_components/jquery.easing/js/jquery.easing.js"></script>    <script src="/bower_components/moment/moment.js"></script>    <script src="/bower_components/angular/angular.min.js"></script>    <script src="/bower_components/angular-sanitize/angular-sanitize.js"></script>    <script src="/bower_components/masonry/dist/masonry.pkgd.min.js"></script>    <script src="/bower_components/packery/dist/packery.pkgd.min.js"></script>    <script src="/bower_components/pace/pace.min.js"></script>    <script src="/bower_components/skycons-html5/skycons.js"></script>    <script src="/bower_components/angular-animate/angular-animate.min.js"></script>    <script src="/bower_components/angular-ui-router/release/angular-ui-router.js"></script>    <script src="/bower_components/angular-ui-router-tabs/src/ui-router-tabs.js"></script>    <script src="/bower_components/angular-ui-bootstrap-bower/ui-bootstrap-tpls.js"></script>    <script src="/bower_components/angular-ui-notification/dist/angular-ui-notification.min.js"></script>    <script src="/bower_components/jcrop/js/jquery.Jcrop.min.js"></script>    <script src="/bower_components/angular-filter/dist/angular-filter.js"></script>    <script src="/additional_components/jQuery.Sparklines/jquery.sparkline.js"></script>    <script src="/bower_components/flot/jquery.flot.js"></script>    <script src="/bower_components/flot/jquery.flot.time.js"></script>    <script src="/bower_components/flot/jquery.flot.resize.js"></script>    <script src="/bower_components/flot.curvedlines/curvedLines.js"></script>    <script src="/bower_components/flot/jquery.flot.pie.js"></script>    <script src="/bower_components/angular-timer/dist/angular-timer.js"></script>    <script src="/bower_components/flot.tooltip/js/jquery.flot.tooltip.min.js"></script>    <script src="/bower_components/angular-flot/angular-flot.js"></script>    <script src="/bower_components/angular-messages/angular-messages.js"></script>    <script src="/bower_components/sweetalert/dist/sweetalert-dev.js"></script>    <script src="/bower_components/signalr/jquery.signalR.min.js"></script>    <script src="/bower_components/lodash/dist/lodash.min.js"></script>    <script src="/bower_components/fastclick/lib/fastclick.js"></script>    <script src="/bower_components/angular-google-maps/dist/angular-google-maps.js"></script>    <script src="/bower_components/marker-animate-unobtrusive/vendor/markerAnimate.js"></script>    <script src="/bower_components/marker-animate-unobtrusive/SlidingMarker.js"></script>    <script src="/bower_components/humanize-duration/humanize-duration.js"></script>    <script src="/bower_components/angular-google-places-autocomplete/src/autocomplete.js"></script>    <script src="/bower_components/angular-dynamic-locale/src/tmhDynamicLocale.js"></script>    <script src="/bower_components/moment-timezone/builds/moment-timezone-with-data.js"></script>    <script src="/bower_components/angularjs-slider/dist/rzslider.js"></script>    <script src="/bower_components/intl-tel-input/build/js/utils.js"></script>    <script src="/bower_components/intl-tel-input/build/js/intlTelInput.min.js"></script>    <script src="/bower_components/bootstrap-daterangepicker/daterangepicker.js"></script>    <script src="/bower_components/ngtweet/dist/ngtweet.min.js"></script>    <script src="/bower_components/angular-ui-sortable/sortable.js"></script>    <script src="/bower_components/card/dist/card.js"></script>    <script src="/bower_components/angular-card/src/card.js"></script>    <script src="/bower_components/tinycolor/dist/tinycolor-min.js"></script>    <script src="/bower_components/tether/dist/js/tether.min.js"></script>    <script src="/bower_components/angular-color-picker/dist/angularjs-color-picker.min.js"></script>    <!-- endbuild -->    <!-- build:model -->    <script src="/models/models.module.js"></script>    <script src="/models/AuditRecord.js"></script>    <script src="/models/Bill.js"></script>    <script src="/models/BillPayment.js"></script>    <script src="/models/Booking.js"></script>    <script src="/models/RepeatBooking.js"></script>    <script src="/models/BookingExpense.js"></script>    <script src="/models/BookingOffer.js"></script>    <script src="/models/BookingRequirement.js"></script>    <script src="/models/BookingStop.js"></script>    <script src="/models/ChangePassword.js"></script>    <script src="/models/Claim.js"></script>    <script src="/models/Client.js"></script>    <script src="/models/ClientDispatchSettings.js"></script>    <script src="/models/DriverPaymentModelOverride.js"></script>    <script src="/models/ClientAdjustment.js"></script>    <script src="/models/ClientInvoiceAdjustment.js"></script>    <script src="/models/ClientPricingModelAdjustment.js"></script>    <script src="/models/ClientReference.js"></script>    <script src="/models/ClientStaff.js"></script>    <script src="/models/ClientStaffRole.js"></script>    <script src="/models/ClientType.js"></script>    <script src="/models/CreditNote.js"></script>    <script src="/models/Company.js"></script>    <script src="/models/Conversation.js"></script>    <script src="/models/Currency.js"></script>    <script src="/models/DispatchSettings.js"></script>    <script src="/models/Document.js"></script>    <script src="/models/DocumentType.js"></script>    <script src="/models/Driver.js"></script>    <script src="/models/DriverPayment.js"></script>    <script src="/models/DriverAdjustment.js"></script>    <script src="/models/DriverPaymentAdjustment.js"></script>    <script src="/models/DriverPaymentModel.js"></script>    <script src="/models/DriverPaymentModelAdjustment.js"></script>    <script src="/models/DriverFixed.js"></script>    <script src="/models/DriverPaymentModelFixed.js"></script>    <script src="/models/DriverType.js"></script>    <script src="/models/EmailConfig.js"></script>    <script src="/models/Invoice.js"></script>    <script src="/models/InvoiceDetail.js"></script>    <script src="/models/FlightInfo.js"></script>    <script src="/models/GoogleMapsConfig.js"></script>    <script src="/models/KnownLocation.js"></script>    <script src="/models/KnownPickupPoint.js"></script>    <script src="/models/Location.js"></script>    <script src="/models/NewUser.js"></script>    <script src="/models/NotificationTemplates.js"></script>    <script src="/models/Note.js"></script>    <script src="/models/Passenger.js"></script>    <script src="/models/PassengerAddress.js"></script>    <script src="/models/Payment.js"></script>    <script src="/models/PricingFixed.js"></script>    <script src="/models/ClientPricingFixed.js"></script>    <script src="/models/PricingModel.js"></script>    <script src="/models/PricingModelVehicleTypePricing.js"></script>    <script src="/models/Zone.js"></script>    <script src="/models/ZoneInPricingModel.js"></script>    <script src="/models/ScoreWeighting.js"></script>    <script src="/models/Staff.js"></script>    <script src="/models/StaffRole.js"></script>    <script src="/models/Tax.js"></script>    <script src="/models/TaxComponent.js"></script>    <script src="/models/TaxType.js"></script>    <script src="/models/User.js"></script>    <script src="/models/Vehicle.js"></script>    <script src="/models/VehicleClass.js"></script>    <script src="/models/VehicleType.js"></script>    <script src="/models/VehicleTypeInDriverFixed.js"></script>    <script src="/models/VehicleTypeInDriverPaymentFixed.js"></script>    <script src="/models/VehicleTypeInPricingFixed.js"></script>    <script src="/models/VehicleTypeInClientPricingFixed.js"></script>    <script src="/models/BookingValidation.js"></script>    <script src="/models/ClientWebBookerSetting.js"></script>    <script src="/models/SmsDetails.js"></script>    <script src="/models/PaymentCard.js"></script>    <script src="/models/Transaction.js"></script>    <script src="/models/CompanyPaymentSettings.js"></script>    <script src="/models/CardPaymentProviderDetail.js"></script>    <script src="/models/AppConfig.js"></script>    <script src="/models/Partner.js"></script>    <script src="/models/PartnerDriver.js"></script>    <script src="/models/PartnerVehicle.js"></script>    <script src="/models/MaskedNumberProviderDetail.js"></script>    <script src="/models/WebBookerDetails.js"></script>    <script src="/models/PassengerAppInvitationDetail.js"></script>    <script src="/models/CompanyBiddingConfig.js"></script>    <script src="/models/DriverBid.js"></script>    <script src="/models/BiddingFilter.js"></script>    <script src="/models/BiddingExclusionRule.js"></script>    <script src="/models/AutoAllocationRule.js"></script>    <script src="/models/TelephonyCall.js"></script>    <script src="/models/TelephonyIntegration.js"></script>    <script src="/models/FTPDetails.js"></script>    <script src="/models/CancellationRule.js"></script>    <script src="/models/FlagDownConfiguration.js"></script>    <script src="/models/CompanyProfile.js"></script>    <script src="/models/Tag.js"></script>    <script src="/models/BookingTag.js"></script>    <script src="/models/LoyaltyConfig.js"></script>    <script src="/models/LoyaltyAccount.js"></script>    <!-- endbuild -->    <script src="https://code.angularjs.org/1.4.6/i18n/angular-locale_en-gb.js"></script>    <script src="https://api.cab9.co/signalr/hubs"></script>    <!-- build:components -->    <script src="/e9_components/services/Logger.service.js"></script>    <script src="/e9_components/services/ConsoleLoggingProvider.service.js"></script>    <script src="/e9_components/services/Model.service.js"></script>    <script src="/e9_components/services/Menu.service.js"></script>    <script src="/e9_components/services/Storage.service.js"></script>    <script src="/e9_components/services/Auth.service.js"></script>    <script src="/e9_components/services/Auth-Persist.service.js"></script>    <script src="/e9_components/services/ImageUpload.service.js"></script>    <script src="/e9_components/services/FileUpload.service.js"></script>    <script src="/e9_components/services/CSV.service.js"></script>    <script src="/e9_components/services/SignalR.service.js"></script>    <script src="/e9_components/services/Google.service.js"></script>    <script src="/e9_components/services/Currency.service.js"></script>    <script src="/e9_components/directives/uiSelect/select.js"></script>    <script src="/e9_components/directives/BindHtmlCompile.directive.js"></script>    <script src="/e9_components/directives/Card.directive.js"></script>    <script src="/e9_components/directives/FieldFor.directive.js"></script>    <script src="/e9_components/directives/StarRating.directive.js"></script>    <script src="/e9_components/directives/international-phone-number.js"></script>    <script src="/e9_components/directives/Score.directive.js"></script>    <script src="/e9_components/directives/tags.directive.js"></script>    <script src="/e9_components/filters/utility.filter.js"></script>    <script src="/e9_components/layouts/structure/page.controller.js"></script>    <script src="/e9_components/layouts/breadcrumb/breadcrumb.controller.js"></script>    <script src="/e9_components/layouts/threepanel/threepanel.controller.js"></script>    <script src="/e9_components/layouts/module/module-cards.controller.js"></script>    <script src="/e9_components/layouts/module/module-secondary-cards.controller.js"></script>    <script src="/e9_components/layouts/module/module-table.controller.js"></script>    <script src="/e9_components/layouts/module/module-item.controller.js"></script>    <script src="/e9_components/layouts/module/module-documents.controller.js"></script>    <script src="/e9_components/layouts/module/module-document-item.controller.js"></script>    <script src="/e9_components/directives/TableFor.directive.js"></script>    <script src="/e9_components/directives/ScrollRepeater.directive.js"></script>    <script src="/e9_components/directives/datepickerwide/directive.js"></script>    <script src="/e9_components/directives/InfoCard.directive.js"></script>    <script src="/e9_components/directives/VirtualizedRepeater.directive.js"></script>    <script src="/e9_components/directives/AddressFinder.directive.js"></script>    <script src="/e9_components/directives/instructions/directive.js"></script>    <script src="/src/js/marker-cluster.js"></script>    <script src="/src/js/Cab9.js"></script>    <!-- endbuild -->    <!-- build:app -->    <script src="/webapp/common/utilities/utilities.js"></script>    <script src="/webapp/common/common.module.js"></script>    <script src="/webapp/layout/sidebar-left/sidebar-left.controller.js"></script>    <script src="/webapp/client/layout/sidebar-left/sidebar-left.controller.js"></script>    <script src="/webapp/layout/topbar/topbar.controller.js"></script>    <script src="/webapp/layout/quick-nav/quick-nav.controller.js"></script>    <script src="/webapp/common/views/numplate/module-number-plate.controller.js"></script>    <script src="/webapp/common/views/numplate/module-number-plate-secondary.controller.js"></script>    <script src="/webapp/common/views/drivers/payments/controller.js"></script>    <script src="/webapp/common/views/drivers/adjustments/controller.js"></script>    <script src="/webapp/common/views/drivers/adjustments/modal/controller.js"></script>    <script src="/webapp/common/views/drivers/user/controller.js"></script>    <script src="/webapp/common/views/clients/invoices/controller.js"></script>    <script src="/webapp/common/views/clients/creditNotes/controller.js"></script>    <script src="/webapp/common/views/clients/staff/options.controller.js"></script>    <script src="/webapp/common/views/clients/staff/details/create.controller.js"></script>    <script src="/webapp/common/views/clients/staff/details/controller.js"></script>    <script src="/webapp/common/views/clients/staff/all/staff-module-stats.controller.js"></script>    <script src="/webapp/common/views/clients/staff/passengers/controller.js"></script>    <script src="/webapp/common/views/clients/passengers/options.controller.js"></script>    <script src="/webapp/common/views/clients/passengers/all/passengers-module-stats.controller.js"></script>    <script src="/webapp/common/views/clients/staff/user/controller.js"></script>    <script src="/webapp/common/views/clients/references/controller.js"></script>    <script src="/webapp/common/views/clients/references/modal/controller.js"></script>    <script src="/webapp/common/views/clients/bannedDrivers/controller.js"></script>    <script src="/webapp/common/views/clients/creditcards/controller.js"></script>    <script src="/webapp/common/views/clients/creditcards/cards/controller.js"></script>    <script src="/webapp/common/views/clients/creditcards/transactions/controller.js"></script>    <script src="/webapp/common/views/clients/webBookerSettings/controller.js"></script>    <script src="/webapp/common/views/clients/clientVehicleTypes/controller.js"></script>    <script src="/webapp/common/views/conversations/conversations.modal.controller.js"></script>    <script src="/webapp/common/views/driverpayments/controller.js"></script>    <script src="/webapp/common/views/driverpayments/details/controller.js"></script>    <script src="/webapp/common/views/driverpayments/bonus/controller.js"></script>    <script src="/webapp/common/views/cardtransactions/controller.js"></script>    <script src="/webapp/common/views/googlemapsconfig/controller.js"></script>    <script src="/webapp/common/directives/stopedit/directive.js"></script>    <script src="/webapp/common/directives/numplate.directive.js"></script>    <script src="/webapp/common/directives/promiseShadow.directive.js"></script>    <script src="/webapp/common/directives/editmodal/directive.js"></script>    <script src="/webapp/common/directives/input-dropdown/directive.js"></script>    <script src="/webapp/common/reports/reports.module.js"></script>    <script src="/webapp/common/reports/bookings-report/report.bookings.directive.js"></script>    <script src="/webapp/common/reports/client-bookings-report/report.bookings.directive.js"></script>    <script src="/webapp/common/reports/bookingSource-report/report.bookingSource.directive.js"></script>    <script src="/webapp/common/reports/client-report/report.client.directive.js"></script>    <script src="/webapp/common/reports/currency-report/report.currency.directive.js"></script>    <script src="/webapp/common/reports/driver-report/report.driver.directive.js"></script>    <script src="/webapp/common/reports/passenger-report/report.passenger.directive.js"></script>    <script src="/webapp/common/reports/paymentType-report/report.paymentType.directive.js"></script>    <script src="/webapp/common/reports/vehicleType-report/report.vehicleType.directive.js"></script>    <script src="/webapp/common/reports/vehicleClass-report/report.vehicleClass.directive.js"></script>    <script src="/webapp/common/modals/notes.modal.controller.js"></script>    <script src="/webapp/common/modals/quick-booking/controller.js"></script>    <script src="/webapp/common/modals/driver-payment-create.controller.js"></script>    <script src="/webapp/common/modals/user/controller.js"></script>    <script src="/webapp/common/modals/add-payment-card/controller.js"></script>    <script src="/webapp/common/modals/passenger/controller.js"></script>    <script src="/webapp/common/modals/webbooker/new/controller.js"></script>    <script src="/webapp/common/modals/webbooker/address/create.controller.js"></script>    <script src="/webapp/common/modals/webbooker/address/edit.controller.js"></script>    <script src="/webapp/common/views/passenger-address/controller.js"></script>    <script src="/webapp/common/modals/address/create.controller.js"></script>    <script src="/webapp/common/modals/address/edit.controller.js"></script>    <script src="/webapp/common/modals/bookings/driver-payment-calculation/controller.js"></script>    <script src="/webapp/common/modals/bookings/edit-booking/controller.js"></script>    <script src="/webapp/common/modals/booker/controller.js"></script>    <script src="/webapp/common/modals/bookings/reuse-booking/controller.js"></script>    <script src="/webapp/common/modals/bookings/stop-address/controller.js"></script>    <script src="/webapp/common/directives/mileagestep/directive.js"></script>    <script src="/webapp/common/directives/partner-card/directive.js"></script>    <script src="/webapp/common/directives/passengerprofile/directive.js"></script>    <script src="/webapp/common/directives/document/directive.js"></script>    <script src="/webapp/common/services/CustomMarker.service.js"></script>    <script src="/webapp/common/widgets/booking-report.widget.js"></script>    <script src="/webapp/common/widgets/booking-client-report.widget.js"></script>    <script src="/webapp/common/widgets/booking-source.widget.js"></script>    <script src="/webapp/common/widgets/booking-revenue.widget.js"></script>    <script src="/webapp/common/widgets/bookings-heatmap.widget.js"></script>    <script src="/webapp/common/widgets/unique-driver-passenger.widget.js"></script>    <script src="/webapp/common/widgets/client-report.widget.js"></script>    <script src="/webapp/common/widgets/driver-report.widget.js"></script>    <script src="/webapp/common/widgets/passenger-report.widget.js"></script>    <script src="/webapp/common/widgets/weather-report.widget.js"></script>    <script src="/webapp/common/widgets/twitter.widget.js"></script>    <script src="/webapp/common/widgets/staff-report.widget.js"></script>    <!-- endbuild -->    <!-- build:individual -->    <script src="/webapp/client/bookings/modals/reuse-booking/controller.js"></script>    <!-- endbuild -->    <script>        window.idCounter = 10000;    </script></head><body ng-controller="ReuseBookingController">    <div ng-if="loading" class="loading-background" style="z-index:10000000">        <div class="loading-panel">            <img src="/includes/images/preloader.gif" />        </div>    </div>    <form name="bookingForm" id="dispatch-booking-edit" form-for="item" schema="Booking" mode="EDIT">        <div class="booking-payment-calculation">            <div class="body">                <h3 class="section-title mt5">New Booking</h3>                <form name="dispatchBookingForm" form-for="item" schema="Booking" mode="CREATE">                    <div ng-include="'/webapp/client/bookings/modals/reuse-booking/booking-info.partial.html'"></div>                    <div class="mt10 footer mb20">                        <button class="btn btn-xl btn-success ml15 mr5" ng-click="save()" id="bookingsave" ng-disabled="formFor.form.$invalid || testMaskReferences() || !canQuote"><i class="material-icons">save</i>Save</button>                        <button class="btn btn-xl btn-warning" ng-click="close()"><i class="material-icons">close</i>Close</button>                    </div>                </form>            </div>        </div>    </form>    <script>        var baseUrl = "https://api.cab9.co";        window.$$permissions = window.opener.$$permissions;        (function (window, angular, baseUrl, undefined) {            var permissionsFix = angular.module('cab9.permissions', ["ui.router"]);            permissionsFix.constant('$permissions', {                role: null,                permissions: [],                test: function (name, right) {                    var result = false;                    if (right == undefined)                        right = 'R';                    var perm = this.permissions.filter(function (p) {                        return (p.hasOwnProperty(name))                    })[0];                    var index = this.permissions.indexOf(perm);                    if (index != -1)                        result = this.permissions[index][name][right];                    return this.permissions.indexOf('superadmin') != -1 || result;                }            });            permissionsFix.config(['$permissions', function ($permissions) {                $permissions.role = window.$$permissions;                $permissions.permissions = JSON.parse(window.$$permissions.Permissions);        }])            permissionsFix.run(['$rootScope', '$permissions', function ($rootScope, $permissions) {                $rootScope.PERMISSIONS = $permissions;        }]);            var app = angular.module('reusebooking', ['ngSanitize', "cab9.common", "cab9.permissions"]);            app.run(runFn);            runFn.$inject = ['Localisation', 'tmhDynamicLocale', 'Model', 'Auth'];            function runFn(Localisation, tmhDynamicLocale, Model, Auth) {                var currencyObj = Localisation.currency();                var currencies = currencyObj.currencies();                Model.Company                    .query()                    .include('DefaultDriverPaymentModel')                    .filter("Id eq guid'" + Auth.getSession().TenantId + "'")                    .execute().then(function (c) {                        //Localisation set functions                        currencies.then(function (res) {                            currencyObj.setCurrent(c[0].DefaultCurrencyId);                            currencyIcon = currencyObj.getCurrent().Prepend;                        });                        if (c[0].DefaultLocale)                            tmhDynamicLocale.set(c[0].DefaultLocale);                        else                            tmhDynamicLocale.set($config.DEFAULT_LOCALE);                        if (c[0].DefaultTimezone) {                            moment.tz.setDefault(c[0].DefaultTimezone);                            Localisation.timeZone().setTimeZone(c[0].DefaultTimezone);                        }                        Localisation.useMetric(c[0].UseMetric);                    });            }            app.filter('PassengerFilter', passengerFilter);            app.filter('BookerFilter', bookerFilter);            app.controller('ReuseBookingController', function ($scope, $http, $location, Model, Localisation, $UI, $controller, $q) {                $scope.loading = true;                $scope.bookingInfo = true;                var searchParams = $location.search();                var id = searchParams.id;                var clientid = searchParams.clientId;                var repeat = searchParams.repeat;                var setupPromises = [];                var bookingPromise = Model.Booking.query().select('ClientId,ActualCost,EstimatedCost,Reference,WaitAndReturn,AsDirected,Client,BookingStops,BookingValidations,Pax,Bax,LeadPassengerId,LeadPassenger,CurrencyId,Currency,BookingRequirements,ClientStaffId,ClientStaff,VehicleType,VehicleTypeId').include('Client,Client/ClientReferences,Client/VehicleTypes,Client/KnownLocations,BookingStops,BookingStops/PassengerStops,Passengers,BookingValidations,LeadPassenger,Currency,BookingRequirements')                    .where("Id eq guid'" + id + "'")                    .trackingEnabled()                    .execute();                setupPromises.push(bookingPromise);                var clientsPromise = Model.Client.query().filter("Id eq guid'" + clientid + "'")                    .select('Id,Name,AllVehicleTypeAccess,VehicleTypes,ClientReferences,KnownLocations,ShowPriceInPortal')                    .include('VehicleTypes,ClientReferences,KnownLocations').execute();                setupPromises.push(clientsPromise);                var passengersPromise = Model.Passenger.query()                    .select('Id,Firstname,Surname,ImageUrl,Mobile,ClientId,Client/Name')                    .filter("ClientId eq guid'" + clientid + "'")                    .include('Client').parseAs(function (item) {                        this.Id = item.Id;                        this.ClientId = item.ClientId;                        this.Name = item.Firstname + ' ' + item.Surname;                        this.Description = ((item.Client && item.Client.Name) ? item.Client.Name : 'No Client');                        this.Mobile = item.Mobile;                        this.ImageUrl = $utilities.formatUrl(item.ImageUrl, item.Name);                    }).execute()                setupPromises.push(passengersPromise);                var taxesPromise = Model.Tax.query().execute();                setupPromises.push(taxesPromise);                $q.all(setupPromises).then(function (results) {                    var c = $controller('ClientBookingReuseModalController', {                        $scope: $scope,                        scope: $scope,                        $UI: $UI,                        $modalInstance: dummyInstance,                        $http: $http,                        $config: $config,                        Model: Model,                        Localisation: Localisation,                        rBooking: results[0],                        rClients: results[1],                        rPassengers: results[2],                        rTaxes: results[3],                    });                    $scope.loading = false;                }, function () {                    window.alert("An error occured!");                });                var dummyInstance = {                    dismiss: function () {},                    close: function () {                        //window.close();                    }                };                return;            });            function passengerFilter() {                return function (input, searchText) {                    if (searchText.trim().length > 0) {                        input = input.filter(function (item) {                            return ((item.Name + item.Mobile + item.Description) + "").toLowerCase().indexOf(searchText.toLowerCase()) > -1 || item.Id == "add-passenger"                        })                    }                    return input;                }            }            function bookerFilter() {                return function (input, searchText) {                    if (searchText.trim().length > 0) {                        input = input.filter(function (item) {                            return ((item.Name + item.Mobile + item.Description) + "").toLowerCase().indexOf(searchText.toLowerCase()) > -1 || item.Id == "add-booker"                        })                    }                    return input;                }            }        }(window, angular, baseUrl));    </script></body></html>